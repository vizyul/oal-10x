<div class="affiliate-dashboard">
    <div class="dashboard-header">
        <h1>Affiliate Dashboard</h1>
        <p class="dashboard-subtitle">Track your referrals and earnings</p>
    </div>

    <!-- Stats Overview -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon">ðŸ‘¥</div>
            <div class="stat-content">
                <div class="stat-value">{{stats.totalClicks}}</div>
                <div class="stat-label">Total Clicks</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">âœ…</div>
            <div class="stat-content">
                <div class="stat-value">{{stats.conversions}}</div>
                <div class="stat-label">Conversions</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">ðŸ“Š</div>
            <div class="stat-content">
                <div class="stat-value">{{stats.conversionRate}}%</div>
                <div class="stat-label">Conversion Rate</div>
            </div>
        </div>

        <div class="stat-card highlight">
            <div class="stat-icon">ðŸ’°</div>
            <div class="stat-content">
                <div class="stat-value">${{stats.pendingCommissions}}</div>
                <div class="stat-label">Pending Commissions</div>
            </div>
        </div>

        <div class="stat-card highlight">
            <div class="stat-icon">âœ“</div>
            <div class="stat-content">
                <div class="stat-value">${{stats.paidCommissions}}</div>
                <div class="stat-label">Paid Commissions</div>
            </div>
        </div>

        <div class="stat-card highlight">
            <div class="stat-icon">ðŸ’µ</div>
            <div class="stat-content">
                <div class="stat-value">${{stats.totalCommissions}}</div>
                <div class="stat-label">Total Earnings</div>
            </div>
        </div>
    </div>

    <!-- Referral Link Section -->
    <div class="referral-link-section">
        <h2>Your Referral Link</h2>
        <div class="link-container">
            <input type="text" id="referralLink" value="{{referralLink}}" readonly>
            <button class="btn btn-copy" onclick="copyReferralLink()">
                <span id="copyIcon">ðŸ“‹</span>
                <span id="copyText">Copy</span>
            </button>
        </div>
        <p class="link-help">Share this link to earn 20% commission on every subscription</p>
    </div>

    <!-- Marketing Materials -->
    <div class="marketing-materials">
        <h2>Marketing Materials</h2>
        <div class="materials-grid">
            <div class="material-card">
                <h3>Email Template</h3>
                <p>Pre-written email template to share with your audience</p>
                <button class="btn btn-secondary" onclick="showEmailTemplate()">View Template</button>
            </div>
            <div class="material-card">
                <h3>Social Media Posts</h3>
                <p>Ready-to-share social media content</p>
                <button class="btn btn-secondary" onclick="showSocialPosts()">View Posts</button>
            </div>
            <div class="material-card">
                <h3>Banner Images</h3>
                <p>Download promotional banners for your website</p>
                <button class="btn btn-secondary" onclick="showBanners()">View Banners</button>
            </div>
        </div>
    </div>

    <!-- Recent Referrals -->
    {{#if referrals}}
    <div class="recent-referrals">
        <h2>Recent Referrals</h2>
        <div class="table-container">
            <table class="referrals-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Status</th>
                        <th>Subscription</th>
                        <th>Commission</th>
                        <th>State</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each referrals}}
                    <tr>
                        <td>{{formatDate this.converted_at}}</td>
                        <td>
                            <span class="badge {{#if this.converted_at}}badge-success{{else}}badge-pending{{/if}}">
                                {{#if this.converted_at}}Converted{{else}}Pending{{/if}}
                            </span>
                        </td>
                        <td>{{this.subscription_tier}}</td>
                        <td class="amount">${{this.commission_amount}}</td>
                        <td>
                            <span class="badge badge-{{this.commission_status}}">
                                {{this.commission_status}}
                            </span>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </div>
    {{else}}
    <div class="no-referrals">
        <div class="empty-state">
            <div class="empty-icon">ðŸŽ¯</div>
            <h3>No Referrals Yet</h3>
            <p>Start sharing your referral link to earn commissions!</p>
            <button class="btn btn-primary" onclick="copyReferralLink()">Copy Your Link</button>
        </div>
    </div>
    {{/if}}

    <!-- Payout Information -->
    <div class="payout-info">
        <h2>Payout Information</h2>
        <div class="info-box">
            <div class="info-item">
                <strong>Minimum Payout:</strong> $50.00
            </div>
            <div class="info-item">
                <strong>Payout Schedule:</strong> Monthly (1st of each month)
            </div>
            <div class="info-item">
                <strong>Payment Method:</strong>
                {{#if paymentMethod}}
                    {{paymentMethod}}
                    <a href="/affiliate/settings" class="link-edit">Edit</a>
                {{else}}
                    <a href="/affiliate/settings" class="link-setup">Setup Payment Method</a>
                {{/if}}
            </div>
        </div>
    </div>
</div>

<!-- Modals -->
<div id="emailTemplateModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal('emailTemplateModal')">&times;</span>
        <h2>Email Template</h2>
        <div class="template-box">
            <p><strong>Subject:</strong> Transform Your YouTube Videos Into 17 Content Pieces Instantly</p>
            <br>
            <p>Hi [Name],</p>
            <br>
            <p>I wanted to share an amazing tool I've been using that has completely transformed how I create content from my YouTube videos.</p>
            <br>
            <p>It's called AmplifyContent.ai, and it automatically converts any YouTube video into 17 different ready-to-publish content pieces - blog posts, social media posts, email newsletters, podcast scripts, and more.</p>
            <br>
            <p>Here's what I love about it:
            <ul>
                <li>Saves hours of content creation time</li>
                <li>AI-powered transcription and generation</li>
                <li>Professional quality output</li>
                <li>Multiple content formats from one video</li>
            </ul>
            </p>
            <br>
            <p>They offer a free trial, so you can test it out risk-free. Check it out here:</p>
            <p><strong>{{referralLink}}</strong></p>
            <br>
            <p>Let me know if you have any questions!</p>
            <br>
            <p>Best,<br>[Your Name]</p>
        </div>
        <button class="btn btn-primary" onclick="copyTemplate()">Copy Template</button>
    </div>
</div>

<style>
.affiliate-dashboard {
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px;
}

.dashboard-header {
    text-align: center;
    margin-bottom: 40px;
}

.dashboard-header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.dashboard-subtitle {
    font-size: 1.2rem;
    color: var(--text-secondary);
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
}

.stat-card {
    background: var(--bg-secondary);
    padding: 25px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-3px);
}

.stat-card.highlight {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
}

.stat-icon {
    font-size: 2.5rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 5px;
}

.stat-label {
    font-size: 0.9rem;
    opacity: 0.8;
}

.referral-link-section {
    background: var(--bg-secondary);
    padding: 30px;
    border-radius: 12px;
    margin-bottom: 40px;
}

.referral-link-section h2 {
    margin-bottom: 20px;
}

.link-container {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

.link-container input {
    flex: 1;
    padding: 15px;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-size: 1rem;
    background: var(--bg-primary);
}

.btn-copy {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 15px 25px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 600;
    transition: background 0.3s ease;
}

.btn-copy:hover {
    background: var(--primary-hover);
}

.link-help {
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.marketing-materials {
    margin-bottom: 40px;
}

.marketing-materials h2 {
    margin-bottom: 20px;
}

.materials-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.material-card {
    background: var(--bg-secondary);
    padding: 25px;
    border-radius: 12px;
    text-align: center;
}

.material-card h3 {
    font-size: 1.3rem;
    margin-bottom: 15px;
}

.material-card p {
    color: var(--text-secondary);
    margin-bottom: 20px;
}

.btn-secondary {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    padding: 10px 20px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.btn-secondary:hover {
    background: var(--border-color);
}

.recent-referrals {
    margin-bottom: 40px;
}

.recent-referrals h2 {
    margin-bottom: 20px;
}

.table-container {
    background: var(--bg-secondary);
    border-radius: 12px;
    overflow: hidden;
}

.referrals-table {
    width: 100%;
    border-collapse: collapse;
}

.referrals-table thead {
    background: var(--bg-tertiary);
}

.referrals-table th {
    padding: 15px;
    text-align: left;
    font-weight: 600;
    color: var(--text-primary);
}

.referrals-table td {
    padding: 15px;
    border-top: 1px solid var(--border-color);
}

.badge {
    display: inline-block;
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
}

.badge-success {
    background: var(--success-bg);
    color: var(--success-color);
}

.badge-pending {
    background: var(--warning-bg);
    color: var(--warning-color);
}

.badge-paid {
    background: var(--success-bg);
    color: var(--success-color);
}

.badge-approved {
    background: var(--info-bg);
    color: var(--info-color);
}

.amount {
    font-weight: 700;
    color: var(--primary-color);
}

.no-referrals {
    background: var(--bg-secondary);
    padding: 60px 20px;
    border-radius: 12px;
    margin-bottom: 40px;
}

.empty-state {
    text-align: center;
}

.empty-icon {
    font-size: 4rem;
    margin-bottom: 20px;
}

.empty-state h3 {
    font-size: 1.5rem;
    margin-bottom: 15px;
}

.empty-state p {
    color: var(--text-secondary);
    margin-bottom: 30px;
}

.payout-info {
    background: var(--bg-secondary);
    padding: 30px;
    border-radius: 12px;
}

.payout-info h2 {
    margin-bottom: 20px;
}

.info-box {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.info-item {
    padding: 15px;
    background: var(--bg-primary);
    border-radius: 8px;
    border-left: 4px solid var(--primary-color);
}

.link-edit, .link-setup {
    margin-left: 10px;
    color: var(--primary-color);
    text-decoration: underline;
    cursor: pointer;
}

.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}

.modal-content {
    background: var(--bg-primary);
    padding: 40px;
    border-radius: 12px;
    max-width: 800px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
}

.modal-close {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 2rem;
    cursor: pointer;
    color: var(--text-secondary);
}

.template-box {
    background: var(--bg-secondary);
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    font-family: monospace;
    line-height: 1.8;
}
</style>

<script>
function copyReferralLink() {
    const linkInput = document.getElementById('referralLink');
    linkInput.select();
    document.execCommand('copy');

    const copyIcon = document.getElementById('copyIcon');
    const copyText = document.getElementById('copyText');

    copyIcon.textContent = 'âœ“';
    copyText.textContent = 'Copied!';

    setTimeout(() => {
        copyIcon.textContent = 'ðŸ“‹';
        copyText.textContent = 'Copy';
    }, 2000);
}

function showEmailTemplate() {
    document.getElementById('emailTemplateModal').style.display = 'flex';
}

function showSocialPosts() {
    alert('Social media templates coming soon!');
}

function showBanners() {
    alert('Banner downloads coming soon!');
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function copyTemplate() {
    const templateBox = document.querySelector('.template-box');
    const range = document.createRange();
    range.selectNode(templateBox);
    window.getSelection().removeAllRanges();
    window.getSelection().addRange(range);
    document.execCommand('copy');
    window.getSelection().removeAllRanges();

    alert('Template copied to clipboard!');
}

// Close modal when clicking outside
window.onclick = function(event) {
    if (event.target.classList.contains('modal')) {
        event.target.style.display = 'none';
    }
}
</script>
